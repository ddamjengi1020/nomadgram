# Migration `20201020031850`

This migration has been generated by ddamjengi1020 at 10/20/2020, 12:18:50 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_userId_fkey"

ALTER TABLE "public"."Like" DROP CONSTRAINT "Like_userId_fkey"

ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_fromUserId_fkey"

ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_toUserId_fkey"

ALTER TABLE "public"."Post" DROP CONSTRAINT "Post_userId_fkey"

ALTER TABLE "public"."_RoomToUser" DROP CONSTRAINT "_RoomToUser_B_fkey"

ALTER TABLE "public"."_follow" DROP CONSTRAINT "_follow_A_fkey"

ALTER TABLE "public"."_follow" DROP CONSTRAINT "_follow_B_fkey"

ALTER TABLE "public"."Comment" ALTER COLUMN "userId" SET DATA TYPE text 

ALTER TABLE "public"."Like" ALTER COLUMN "userId" SET DATA TYPE text 

ALTER TABLE "public"."Message" ALTER COLUMN "fromUserId" SET DATA TYPE text ,
ALTER COLUMN "toUserId" SET DATA TYPE text 

ALTER TABLE "public"."Post" ALTER COLUMN "userId" SET DATA TYPE text 

ALTER TABLE "public"."User" DROP CONSTRAINT "User_pkey",
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "User_id_seq"

ALTER TABLE "public"."_RoomToUser" ALTER COLUMN "B" SET DATA TYPE text 

ALTER TABLE "public"."_follow" ALTER COLUMN "A" SET DATA TYPE text ,
ALTER COLUMN "B" SET DATA TYPE text 

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Like" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("fromUserId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("toUserId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_RoomToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_follow" ADD FOREIGN KEY ("A")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_follow" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200919134049-test-finish..20201020031850
--- datamodel.dml
+++ datamodel.dml
@@ -4,17 +4,17 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id        Int     @id @default(autoincrement())
+  id        String  @id @default(uuid())
   userName  String  @unique
   email     String  @unique
   firstName String  @default("")
   lastName  String
@@ -34,27 +34,27 @@
   id       Int @id @default(autoincrement())
   location String
   caption  String
   user     User @relation(fields: [userId], references: [id])
-  userId   Int
+  userId   String
   likes    Like[]
   comments Comment[] 
   files    File[] 
 }
 model Like {
   id     Int @id @default(autoincrement())
   user   User @relation(fields: [userId], references: [id])
-  userId Int
+  userId String
   post   Post @relation(fields: [postId], references: [id])
   postId Int
 }
 model Comment {
   id     Int @id @default(autoincrement())
   text   String
   user   User @relation(fields: [userId], references:[id])
-  userId Int
+  userId String
   post   Post @relation(fields: [postId], references: [id])
   postId Int
 }
@@ -74,10 +74,10 @@
 model Message {
     id     Int @id @default(autoincrement())
     text   String
     from   User @relation("from", fields:[fromUserId], references: [id])
-    fromUserId Int
+    fromUserId String
     to     User @relation("to", fields: [toUserId], references: [id])
-    toUserId Int
+    toUserId String
     room   Room @relation(fields: [roomId], references:[id])
     roomId Int
 }
```


